
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="index, follow" />

  <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,400italic' rel='stylesheet' type='text/css'>

    <link rel="stylesheet/less" type="text/css" href="https://theodox.github.io/theme/stylesheet/style.less">
    <script src="//cdnjs.cloudflare.com/ajax/libs/less.js/2.5.1/less.min.js" type="text/javascript"></script>

  <link rel="stylesheet" type="text/css" href="https://theodox.github.io/theme/pygments/native.min.css">
  <link rel="stylesheet" type="text/css" href="https://theodox.github.io/theme/font-awesome/css/font-awesome.min.css">


    <link href="https://theodox.github.io/feeds/atom.xml" type="application/atom+xml" rel="alternate" title="Chimeras & Manticores Atom">

    <link href="https://theodox.github.io/feeds/rss.xml" type="application/rss+xml" rel="alternate" title="Chimeras & Manticores RSS">


<!-- Google Analytics -->
<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-79232212-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- End Google Analytics -->

<meta name="author" content="Steve Theodore" />
<meta name="description" content="A quick review of the Python namedtuple — a great way to return complex data from your functions without needing complex custom classes." />
<meta name="keywords" content="maya, python, programming">

<meta property="og:site_name" content="Chimeras & Manticores"/>
<meta property="og:title" content="Return of the namedtuples"/>
<meta property="og:description" content="A quick review of the Python namedtuple — a great way to return complex data from your functions without needing complex custom classes."/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="https://theodox.github.io/2015/return_of_the_namedtuples"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2015-08-02 17:59:00-07:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="https://theodox.github.io/author/steve-theodore.html">
<meta property="article:section" content="blog"/>
<meta property="article:tag" content="maya"/>
<meta property="article:tag" content="python"/>
<meta property="article:tag" content="programming"/>
<meta property="og:image" content="">

   <title>Chimeras & Manticores &ndash; Return of the namedtuples</title>


    <link rel="canonical" href="https://theodox.github.io/2015/return_of_the_namedtuples"/>

  <script type="text/javascript">
    var host = "https://theodox.github.io";
    if ((host == window.location.host) && (window.location.protocol != "https:"))
      window.location.protocol = "https";
  </script>

</head>
<body>



  <aside>
    <div>
      <h2>Chimeras & Manticores</h2>
      <a href="https://theodox.github.io">
        <img src="https://theodox.github.io/theme/img/profile.png" alt="" title="">
      </a>
      <h1><a href="https://theodox.github.io"></a></h1>

<p>a blog about technical art, python, the games business, and obscurantism</p>


      <ul class="social">
        <li><a class="sc-linkedin" href="https://www.linkedin.com/in/stevetheodore" target="_blank"><i class="fa fa-linkedin"></i></a></li>
        <li><a class="sc-github" href="https://github.com/theodox" target="_blank"><i class="fa fa-github"></i></a></li>
        <li><a class="sc-google" href="https://plus.google.com/u/0/+SteveTheodore480BC/posts" target="_blank"><i class="fa fa-google"></i></a></li>
        <li><a class="sc-stack-overflow" href="http://stackoverflow.com/users/1936075/theodox" target="_blank"><i class="fa fa-stack-overflow"></i></a></li>
      </ul>

    <nav>
<!---if pages or LINKS -->


        <div>
          <h3 class="tagcloud_header">SUBJECTS</h3>
        </div>
        <ul class="tagcloud">
            <li class="tag-3">
                <a href="https://theodox.github.io/tag/animation.html">
                animation
                        <span class="badge">(3)</span>
                </a>
            </li>
            <li class="tag-3">
                <a href="https://theodox.github.io/tag/api.html">
                api
                        <span class="badge">(3)</span>
                </a>
            </li>
            <li class="tag-3">
                <a href="https://theodox.github.io/tag/articles.html">
                articles
                        <span class="badge">(2)</span>
                </a>
            </li>
            <li class="tag-3">
                <a href="https://theodox.github.io/tag/blog.html">
                blog
                        <span class="badge">(3)</span>
                </a>
            </li>
            <li class="tag-2">
                <a href="https://theodox.github.io/tag/blogging.html">
                blogging
                        <span class="badge">(4)</span>
                </a>
            </li>
            <li class="tag-3">
                <a href="https://theodox.github.io/tag/boo.html">
                boo
                        <span class="badge">(3)</span>
                </a>
            </li>
            <li class="tag-2">
                <a href="https://theodox.github.io/tag/books.html">
                books
                        <span class="badge">(5)</span>
                </a>
            </li>
            <li class="tag-2">
                <a href="https://theodox.github.io/tag/bugs.html">
                bugs
                        <span class="badge">(5)</span>
                </a>
            </li>
            <li class="tag-2">
                <a href="https://theodox.github.io/tag/cg.html">
                cg
                        <span class="badge">(8)</span>
                </a>
            </li>
            <li class="tag-3">
                <a href="https://theodox.github.io/tag/distribution.html">
                distribution
                        <span class="badge">(3)</span>
                </a>
            </li>
            <li class="tag-2">
                <a href="https://theodox.github.io/tag/games.html">
                games
                        <span class="badge">(10)</span>
                </a>
            </li>
            <li class="tag-2">
                <a href="https://theodox.github.io/tag/gdc.html">
                gdc
                        <span class="badge">(12)</span>
                </a>
            </li>
            <li class="tag-3">
                <a href="https://theodox.github.io/tag/graphics.html">
                graphics
                        <span class="badge">(2)</span>
                </a>
            </li>
            <li class="tag-2">
                <a href="https://theodox.github.io/tag/gui.html">
                gui
                        <span class="badge">(7)</span>
                </a>
            </li>
            <li class="tag-1">
                <a href="https://theodox.github.io/tag/industry.html">
                industry
                        <span class="badge">(34)</span>
                </a>
            </li>
            <li class="tag-3">
                <a href="https://theodox.github.io/tag/jobs.html">
                jobs
                        <span class="badge">(2)</span>
                </a>
            </li>
            <li class="tag-3">
                <a href="https://theodox.github.io/tag/markdown.html">
                markdown
                        <span class="badge">(3)</span>
                </a>
            </li>
            <li class="tag-2">
                <a href="https://theodox.github.io/tag/math.html">
                math
                        <span class="badge">(5)</span>
                </a>
            </li>
            <li class="tag-1">
                <a href="https://theodox.github.io/tag/maya.html">
                maya
                        <span class="badge">(45)</span>
                </a>
            </li>
            <li class="tag-2">
                <a href="https://theodox.github.io/tag/mgui.html">
                mgui
                        <span class="badge">(10)</span>
                </a>
            </li>
            <li class="tag-3">
                <a href="https://theodox.github.io/tag/minq.html">
                minq
                        <span class="badge">(2)</span>
                </a>
            </li>
            <li class="tag-3">
                <a href="https://theodox.github.io/tag/modeling.html">
                modeling
                        <span class="badge">(2)</span>
                </a>
            </li>
            <li class="tag-3">
                <a href="https://theodox.github.io/tag/modules.html">
                modules
                        <span class="badge">(3)</span>
                </a>
            </li>
            <li class="tag-3">
                <a href="https://theodox.github.io/tag/moonrise.html">
                moonrise
                        <span class="badge">(2)</span>
                </a>
            </li>
            <li class="tag-3">
                <a href="https://theodox.github.io/tag/pipeline.html">
                pipeline
                        <span class="badge">(2)</span>
                </a>
            </li>
            <li class="tag-1">
                <a href="https://theodox.github.io/tag/programming.html">
                programming
                        <span class="badge">(36)</span>
                </a>
            </li>
            <li class="tag-1">
                <a href="https://theodox.github.io/tag/python.html">
                python
                        <span class="badge">(47)</span>
                </a>
            </li>
            <li class="tag-3">
                <a href="https://theodox.github.io/tag/rigging.html">
                rigging
                        <span class="badge">(2)</span>
                </a>
            </li>
            <li class="tag-3">
                <a href="https://theodox.github.io/tag/sfx.html">
                sfx
                        <span class="badge">(2)</span>
                </a>
            </li>
            <li class="tag-1">
                <a href="https://theodox.github.io/tag/techart.html">
                techart
                        <span class="badge">(20)</span>
                </a>
            </li>
            <li class="tag-1">
                <a href="https://theodox.github.io/tag/tools.html">
                tools
                        <span class="badge">(16)</span>
                </a>
            </li>
            <li class="tag-2">
                <a href="https://theodox.github.io/tag/unity.html">
                unity
                        <span class="badge">(4)</span>
                </a>
            </li>
            <li class="tag-2">
                <a href="https://theodox.github.io/tag/web.html">
                web
                        <span class="badge">(6)</span>
                </a>
            </li>
      </ul>
      </nav>
    </div>


  </aside>
  <main>

    <nav>
      <a href="https://theodox.github.io">    Home
</a>

      <a href="/about">About...</a>
      <a href="/pages/pub">Publications</a>
      <a href="/pages/cookbook">Cookbook</a>
      <a href="/archives">By date</a>
      <a href="/tags">By subject</a>

      <a href="https://theodox.github.io/feeds/atom.xml">    Atom
</a>

      <a href="https://theodox.github.io/feeds/rss.xml">    RSS
</a>
    </nav>

<article class="single">
  <header>
      
    <h1 id="return_of_the_namedtuples">Return of the&nbsp;namedtuples</h1>
    <p>
          Posted on Sun 02 August 2015 in <a href="https://theodox.github.io/category/blog.html">blog</a>


    </p>
  </header>


  <div>
    <p>I’m sure you’ve read or written code that looks like&nbsp;this:  </p>
<div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">some_function</span><span class="p">()</span>  
<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>  
    <span class="n">cmds</span><span class="o">.</span><span class="n">setAttr</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">item</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</pre></div>


<p>Here <code>some_function</code> must be using one of Python’s handiest features, the ability to return lists or tuples of different types in a single function. Python’s ability to return ‘whatever’ - a list, a tuple, or a single object – makes it easy to assemble a stream of data in one place and consume it in others wihout worrying about type declarations or creating a custom class to hold the results. Trying to create a similarly flexible system in, say, C# involves a lot of type-mongering. So it’s&nbsp;nice.  </p>
<p>At least, it’s nice <em>at first</em>. Unfortunately it’s got some serious drawbacks that will become apparent after a while – outside the context of a single script or function, relying entirely on indices to keep things straight is dangerous. As so often in Pythonia, freedom and flexibility can come at the cost of chaos downstream if you’re not&nbsp;careful.  </p>
<p><a href="https://encrypted-tbn3.gstatic.com/images?q=tbn:ANd9GcRd4-Lzu45urv3dmdng5DMjdlO-ILlLVxoa-HeHMZ8uczP4fLWC"><img alt="" src="https://encrypted-tbn3.gstatic.com/images?q=tbn:ANd9GcRd4-Lzu45urv3dmdng5DMjdlO-ILlLVxoa-HeHMZ8uczP4fLWC"></a></p>
<h1><a href="https://www.blogger.com/blogger.g?blogID=3596910715538761404#i-have-a-bad-feeling-about-this"></a>I have a bad feeling about&nbsp;this…</h1>
<p>Everything will be hunky-dory as long as <code>some_function</code> continues to pack its output the same way. In this example <code>some_function</code> is probably doing something&nbsp;like:  </p>
<div class="highlight"><pre><span></span><span class="c1"># imagine some actual code here ...  </span>
<span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>  
<span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">object_list</span>  
    <span class="k">for</span> <span class="n">attrib</span> <span class="ow">in</span> <span class="n">attrib_list</span><span class="p">:</span>  
        <span class="n">settable</span> <span class="o">=</span> <span class="n">is_attrib_settable</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">attrib</span><span class="p">)</span>  
        <span class="k">if</span> <span class="n">settable</span><span class="p">:</span>  
           <span class="n">new_value</span> <span class="o">=</span> <span class="n">dict_of_defaults</span><span class="p">[</span><span class="n">attrib</span><span class="p">]</span>  
           <span class="n">results</span><span class="o">.</span><span class="n">append</span> <span class="p">([</span><span class="n">node</span><span class="p">,</span> <span class="n">attrib</span><span class="p">,</span> <span class="n">new_value</span><span class="p">])</span>  
<span class="k">return</span> <span class="n">results</span>
</pre></div>


<p>Inevitably, though, something will come along that causes the order of the results to change. In a Maya example like this, for example, the likely cause would be some other user of this function finding out that the code needs to set defaults on an unusual value type. <code>setAttr</code> needs to be told what type of data to expect if things are&nbsp;unusual.  </p>
<p>That being the case, your teammate extends <code>some_function</code> to output the data type needed. If you’re lucky, the results look like <code>[node, attribute, value, type]</code> and your existing code works fine. But if it changes to <code>[node, attribute, type, value]</code> your existing code will break in wierd ways. Moreover if you haven’t written a lot of comments, the person fixing the bugs will have to sit down and deduce what <code>item[0]</code>, <code>item[1]</code> and <code>item[2]</code> were supposed to&nbsp;be.   </p>
<p>This example is a perfect illustration unit tests are such a nice thing to have in Python-land: a unit test would probably catch the change in signature right away, alerting your helpful co-worker to the can of worms they have opened up by changing the output of the function. But the real moral of the story is how dangerous it is to rely on implicit knowledge of structures – like the ordering of a list – instead of on explicit instructions. When somebody fails to understand the implications of that ordering, bad things will happen. When the knowledge you need to debug the problem is hidden, things will be<br>
even&nbsp;worse.  </p>
<p><a href="http://images6.fanpop.com/image/photos/36000000/Harrison-in-Star-Wars-Empire-strikes-back-harrison-ford-36029606-3257-2231.jpg"><img alt="" src="http://images6.fanpop.com/image/photos/36000000/Harrison-in-Star-Wars-Empire-strikes-back-harrison-ford-36029606-3257-2231.jpg"></a></p>
<blockquote>
<p>Sometimes things get&nbsp;complicated</p>
</blockquote>
<h2>Return classes strike&nbsp;back</h2>
<p>In most languages the way around this is to create a class that holds the results of something like <code>some_function</code>. A result class provides clear, named access to what’s going&nbsp;on:  </p>
<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SomeFuncResult</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>  
     <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>  
         <span class="bp">self</span><span class="o">.</span><span class="n">node</span> <span class="o">=</span> <span class="n">node</span>  
         <span class="bp">self</span><span class="o">.</span><span class="n">attribute</span> <span class="o">=</span> <span class="n">attr</span>  
         <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">val</span>

 <span class="c1"># and inside of some_function()  </span>
<span class="o">...</span>  
    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SomeFuncResult</span><span class="p">(</span><span class="nb">object</span><span class="p">,</span> <span class="n">attrib</span><span class="p">,</span> <span class="n">val</span><span class="p">))</span>  
<span class="o">...</span>
</pre></div>


<p>This means the receiving code is much neater and easier to&nbsp;understand:  </p>
<div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">some_function</span><span class="p">()</span>  
<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>  
    <span class="n">cmds</span><span class="o">.</span><span class="n">setAttr</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">node</span><span class="o">+</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="n">item</span><span class="o">.</span><span class="n">attribute</span><span class="p">,</span> <span class="n">item</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</pre></div>


<p>This is a better record of what you were trying to achieve in the first place, and it’s also much more survivable: as long as HelpfulCoworker01 does not actually rename the fields in the result object it can be tweaked and updated without causing&nbsp;problems.  </p>
<h2>A bit less&nbsp;classy</h2>
<p>For many cases this is the right way to go. However it comes with some drawbacks of its&nbsp;own.   </p>
<p>First off – let’s be honest – there’s a lot of typing for something so dull. I always try to leave that out of the equation when I can - the time spent typing the code is such a tiny fraction of the time you’ll spend reading it that trying to save a few keystrokes is usually a Bad Idea (tm). However, typing 5 lines when you could just type a pair of bracket does feel like an imposition – particularly when the 5 lines are 100% boring&nbsp;boilerplate.  </p>
<p>The second issue is that, being a class, <code>SomeFuncResult</code> is comparatively expensive: it costs a smidge more in both memory and processor time than just a list or a tuple of values. I’m ranking this behind the typing costs deliberately, because most of the time that increment of cost doesn’t matter at all: if you’re dealing with a few hundred or even a few thousand of them, at a time the costs for spinning up new instances of <code>SomeFuncResult</code> just to hold data are going to be invisible to users. However, if you are doing something more performance-intensive the costs of creating a full mutable object can be significant in large numbers. As always, <a href="the_right_profile.html">it’s wiser not to try to optimize until things are working</a> but this is still a consideration worth&nbsp;recalling.  </p>
<p>The last issue (but probably the most important) is that <code>SomeFuncResult</code> can be changed in flight. Since it is a class, the data in a <code>SomeFuncResult</code> can be updated (for you <span class="caps">CS</span> types, it is <em>mutable</em>). This means some other piece of code that looks at the result object in between <code>some_function</code> and you might can decide to mess with the results. That can be a feature or a bug depending on how you want to code it – but since Python does not have a built-in mechanism for locking fields in an object, you’d have to put in extra work to make sure the results didn’t get changed by accident if keeping the data pristine was mission-critical. You can use the a property decorator to make a fake read only&nbsp;field:  </p>
<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SomeFuncResult</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>  
     <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>  
         <span class="bp">self</span><span class="o">.</span><span class="n">_node</span> <span class="o">=</span> <span class="n">node</span>  
         <span class="bp">self</span><span class="o">.</span><span class="n">_attribute</span> <span class="o">=</span> <span class="n">attr</span>  
         <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="n">val</span>

    <span class="nd">@property</span>  
    <span class="k">def</span> <span class="nf">node</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_node</span>

    <span class="nd">@property</span>  
    <span class="k">def</span> <span class="nf">attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attribute</span>

    <span class="nd">@property</span>  
    <span class="k">def</span> <span class="nf">value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span>
</pre></div>


<p>Alas, our 5 lines of boilerplate have now blossomed into 16. Our quest for clarity is getting&nbsp;expensive.  </p>
<p><a href="https://s-media-cache-ak0.pinimg.com/originals/ec/cf/c1/eccfc13e87cc987cbe29fadb248e3b6b.jpg"><img alt="" src="https://s-media-cache-ak0.pinimg.com/originals/ec/cf/c1/eccfc13e87cc987cbe29fadb248e3b6b.jpg"></a></p>
<h2>obiter&nbsp;dicta</h2>
<p>One common way to get around the hassles – or at least, they typing costs –of custom return objects is simply to use dictionaries instead. If you use the <a href="http://www.perforce.com/perforce/doc.current/user/p4pythonnotes.txt">perforce Python <span class="caps">API</span></a> you’ll be quite familiar with this strategy; instead of creating a class, you just return dictionaries with nice descriptive&nbsp;names   </p>
<div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">object_list</span>  
    <span class="k">for</span> <span class="n">attrib</span> <span class="ow">in</span> <span class="n">attrib_list</span><span class="p">:</span>  
        <span class="n">settable</span> <span class="o">=</span> <span class="n">is_attrib_settable</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">attrib</span><span class="p">)</span>  
        <span class="k">if</span> <span class="n">settable</span><span class="p">:</span>  
           <span class="n">new_value</span> <span class="o">=</span> <span class="n">dict_of_defaults</span><span class="p">[</span><span class="n">attrib</span><span class="p">]</span>  
           <span class="n">results</span><span class="o">.</span><span class="n">append</span> <span class="p">({</span><span class="s1">&#39;node&#39;</span><span class="p">:</span><span class="n">node</span><span class="p">,</span> <span class="s1">&#39;attribute&#39;</span><span class="p">:</span><span class="n">attrib</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span><span class="n">new_value</span><span class="p">})</span>  
<span class="k">return</span> <span class="n">results</span>
</pre></div>


<p>Like a custom class this increases readability and clarity; it’s also future proof since you can add more fields to the dictionary without messing with existing&nbsp;data.   </p>
<p>Even better, dictionaries – unlike classes – are self-describing: in order to understand the contents of a custom result class like <code>SomeFuncResult</code> you’ll have to look at the source code, whereas you can see the contents of a result dictionary with a simple print statement. Dictionaries are slightly cheaper than classes (there is a <a href="http://stackoverflow.com/questions/1336791/dictionary-vs-object-which-is-more-efficient-and-why">good workaround</a> to speed up classes, but it’s something you have to write and maintain). And, of course, dictionaries have minimal setup costs: they are boiler-plate&nbsp;free.  </p>
<p>This doesn’t mean they are ideal for all circumstances,&nbsp;however.</p>
<p>The Achilles’ heel of using dictionaries is keys, which are likely to be strings. Unless you are very disciplined about using named constants for all your result dictionaries you’ll inevitably find that somebody somewhere has typed <code>attribite</code> with an  <em>i</em> instead of a <em>u</em> and suddenly perfectly valid, impeccably logical code is failing because nobody thought to look at the key names. Instead of typing lots of setup code once, you’ll be dribbling out square brackets and quotes till the end of time, with lots of little missteps and typos along the way. While that’s not an insurmoutable problem it’s another&nbsp;annoyance.  </p>
<p><a href="http://assets7.thrillist.com/v1/image/1335116/size/tl-horizontal_main_2x/amazing-1983-return-of-the-jedi-photos-you-ve-never-seen"><img alt="" src="http://assets7.thrillist.com/v1/image/1335116/size/tl-horizontal_main_2x/amazing-1983-return-of-the-jedi-photos-you-ve-never-seen"></a></p>
<blockquote>
<p>Not so scary when you know the&nbsp;secret!</p>
</blockquote>
<h1><a href="https://www.blogger.com/blogger.g?blogID=3596910715538761404#return-of-the-namedtuples"></a>Return of the&nbsp;namedtuples</h1>
<p>Luckily there is yet another – and for most purposes better – way to return complex results — one that is both flexible and self-describing. <a href="http://pymotw.com/2/collections/namedtuple.html">namedtuples</a> are part of the python standard library and they offer a clean, simple way to create lightweight objects that have named properties – like classes – but require almost no setup: you can create a new type of named tuple with a single line of code, and then use it like a lightweight (and immutable) class.<br>
A namedtuple is just a python tuple that can also use names to access it’s own fields. For&nbsp;example:  </p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">namedtuple</span>

<span class="c1"># create a namedtuple called &#39;SomeFuncRes&#39; to hold nodes, attributes and values  </span>
<span class="n">SomeFuncRes</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s2">&quot;SomeFuncRes&quot;</span><span class="p">,</span> <span class="s2">&quot;node attribute value&quot;</span><span class="p">)</span>

<span class="c1"># make an instance  </span>
<span class="n">example</span> <span class="o">=</span> <span class="n">SomeFuncRes</span><span class="p">(</span><span class="s1">&#39;pCube1&#39;</span><span class="p">,</span> <span class="s1">&#39;tx&#39;</span><span class="p">,</span> <span class="mf">33.0</span><span class="p">)</span>  
<span class="c1"># Result: SomeFuncRes(node=&#39;pCube1&#39;, attribute=&#39;tx&#39;, value=33.0)</span>
</pre></div>


<p>As you can see, namedtuples are as even easier to ‘read’ than dictionaries when printed out. However, namedtuples give you dot-access to their&nbsp;contents.</p>
<div class="highlight"><pre><span></span><span class="k">print</span> <span class="n">example</span><span class="o">.</span><span class="n">node</span>  
<span class="c1"># pCube1</span>
</pre></div>


<p>This saves a few characters: <code>result.node</code> beats <code>result['node']</code> – but mopre important offers with far fewer opportunities for mistyped keys or open quotes. <br>
However, namedtuples can also use old-fashioned indexed access&nbsp;too:  </p>
<div class="highlight"><pre><span></span><span class="k">print</span> <span class="n">example</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  
<span class="c1"># pCube1</span>
</pre></div>


<p>And you can even iterate over them if you need to, since a namedtuple is in the end just a slightly fancier&nbsp;tuple:  </p>
<div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">example</span><span class="p">:</span>  
    <span class="k">print</span> <span class="n">item</span>

<span class="c1"># pCube1  </span>
<span class="c1"># tx  </span>
<span class="c1"># 30</span>
</pre></div>


<p>Namedtuples are easy to instantiate: You can create them using index ordering, names, or **keyword arguments. Names tend to be better for clarity, but if you’re expanding the results of other functions like <code>zip()</code> indices and double-starred dictionaries can be very handy. Having all three options allows you to create them in the most appropriate&nbsp;way.  </p>
<div class="highlight"><pre><span></span><span class="k">print</span> <span class="n">SomeFuncRes</span><span class="p">(</span><span class="s1">&#39;pSphere1&#39;</span><span class="p">,</span> <span class="s1">&#39;ry&#39;</span><span class="p">,</span> <span class="mi">180</span><span class="p">)</span>  
<span class="c1"># SomeFuncRes(node=&#39;pSphere1&#39;, attribute=&#39;ry&#39;, value=180)  </span>
<span class="k">print</span> <span class="n">SomeFuncRes</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">node</span> <span class="o">=</span> <span class="s1">&#39;pCube1&#39;</span><span class="p">,</span> <span class="n">attribute</span> <span class="o">=</span> <span class="s1">&#39;tz&#39;</span><span class="p">)</span>  
<span class="c1"># SomeFuncRes(node=&#39;pCube1&#39;, attribute=&#39;tz&#39;, value=1)  </span>
<span class="n">from_dict</span>  <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;node&#39;</span><span class="p">:</span><span class="s1">&#39;pPlane1&#39;</span><span class="p">,</span> <span class="s1">&#39;attribute&#39;</span><span class="p">:</span><span class="s1">&#39;rz&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span><span class="mf">40.5</span><span class="p">}</span>  
<span class="n">SomeFuncRes</span><span class="p">(</span><span class="o">**</span><span class="n">from_dict</span><span class="p">)</span>  
<span class="c1"># SomeFuncRes(node=&#39;pPlane1&#39;, attribute=&#39;rz&#39;, value=40.5)</span>
</pre></div>


<p>One of the great advantages of namedtuples is that (unlike classes or dictionaries) namedtuples are <em>immutable</em>; that is, they are read-only by default. This is usually a Good Thing<sup>tm</sup> for a result object, since data changing in mid-flight can lead to subtle bugs that may be very hard to reproduce. Immutability also makes them cheaper: they don’t require Python to do as much setup behind then scenes when a they are created, which can be significant in large quantities. They usually <a href="http://blog.explainmydata.com/2012/07/expensive-lessons-in-python-performance.html">take up less memory as well</a>.   </p>
<p>This combination of features is tough to beat in a cheapo data-only class. If for some reason you need to upgrade to a real class instead, you probably won’t even need to change the code which reads your namedtuples: Python doesn’t care if <code>result.node</code> is a namedtuple field or a regular object field. For all these reasons, namedtuples are a great little tool for a lot of common data-bundling jobs. No strategy fits every battle, but namedtuples are an excellent - and often overlooked! – way to manage this very common (albeit not very interesting) problem and to keep your overall toolkit cleaner, more robust and easier to&nbsp;maintain.  </p>
<p><a href="http://iruntheinternet.com/lulzdump/images/its-a-trap-pun-its-a-wrap-admiral-ackbar-star-wars-1363199217Z.jpg?id=784"><img alt="" src="http://iruntheinternet.com/lulzdump/images/its-a-trap-pun-its-a-wrap-admiral-ackbar-star-wars-1363199217Z.jpg?id=784"></a></p>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="https://theodox.github.io/tag/maya.html">maya</a>
      <a href="https://theodox.github.io/tag/python.html">python</a>
      <a href="https://theodox.github.io/tag/programming.html">programming</a>
    </p>
  </div>

  <div class="center social-share">
    <p>    Like this article? Share it with your friends!
</p>
    <div class="addthis_native_toolbox"></div>
    <div class="addthis_sharing_toolbox"></div>
    <div class="addthis_inline_share_toolbox"></div>
  </div>


    <div class="addthis_relatedposts_inline"></div>


<!-- Disqus -->
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'theodoxcom';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>
        Please enable JavaScript to view comments.

</noscript>
<!-- End Disqus -->
</article>

    <footer>
<p>&copy;  2018</p>
<p>    Powered by <a href="http://getpelican.com" target="_blank">Pelican</a> - <a href="https://github.com/alexandrevicenzi/flex" target="_blank">Flex</a> theme by <a href="http://alexandrevicenzi.com" target="_blank">Alexandre Vicenzi</a>
</p>    </footer>
  </main>


    <script type="text/javascript" src="https://s7.addthis.com/js/300/addthis_widget.js#pubid=ra-575daef5596b169a"></script>


<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Chimeras & Manticores ",
  "url" : "https://theodox.github.io",
  "image": "",
  "description": ""
}
</script>

</body>
</html>