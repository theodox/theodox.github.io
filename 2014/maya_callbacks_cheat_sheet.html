
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="index, follow" />

  <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,400italic' rel='stylesheet' type='text/css'>

    <link rel="stylesheet/less" type="text/css" href="https://theodox.github.io/theme/stylesheet/style.less">
    <script src="//cdnjs.cloudflare.com/ajax/libs/less.js/2.5.1/less.min.js" type="text/javascript"></script>

  <link rel="stylesheet" type="text/css" href="https://theodox.github.io/theme/pygments/native.min.css">
  <link rel="stylesheet" type="text/css" href="https://theodox.github.io/theme/font-awesome/css/font-awesome.min.css">


    <link href="https://theodox.github.io/feeds/atom.xml" type="application/atom+xml" rel="alternate" title="Chimeras & Manticores Atom">

    <link href="https://theodox.github.io/feeds/rss.xml" type="application/rss+xml" rel="alternate" title="Chimeras & Manticores RSS">


<!-- Google Analytics -->
<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-79232212-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- End Google Analytics -->

<meta name="author" content="Steve Theodore" />
<meta name="description" content="An overiew of how Maya GUI callbacks work, along with some recommendations for how to set them up neatly." />
<meta name="keywords" content="Maya, GUI, python, programming">

<meta property="og:site_name" content="Chimeras & Manticores"/>
<meta property="og:title" content="Maya callbacks cheat sheet"/>
<meta property="og:description" content="An overiew of how Maya GUI callbacks work, along with some recommendations for how to set them up neatly."/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="https://theodox.github.io/2014/maya_callbacks_cheat_sheet"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2014-04-23 13:53:00.001000-07:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="https://theodox.github.io/author/steve-theodore.html">
<meta property="article:section" content="blog"/>
<meta property="article:tag" content="Maya"/>
<meta property="article:tag" content="GUI"/>
<meta property="article:tag" content="python"/>
<meta property="article:tag" content="programming"/>
<meta property="og:image" content="">

   <title>Chimeras & Manticores &ndash; Maya callbacks cheat sheet</title>


    <link rel="canonical" href="https://theodox.github.io/2014/maya_callbacks_cheat_sheet"/>

  <script type="text/javascript">
    var host = "https://theodox.github.io";
    if ((host == window.location.host) && (window.location.protocol != "https:"))
      window.location.protocol = "https";
  </script>

</head>
<body>



  <aside>
    <div>
      <h2>Chimeras & Manticores</h2>
      <a href="https://theodox.github.io">
        <img src="https://theodox.github.io/theme/img/profile.png" alt="" title="">
      </a>
      <h1><a href="https://theodox.github.io"></a></h1>

<p>a blog about technical art, python, the games business, and obscurantism</p>


      <ul class="social">
        <li><a class="sc-linkedin" href="https://www.linkedin.com/in/stevetheodore" target="_blank"><i class="fa fa-linkedin"></i></a></li>
        <li><a class="sc-github" href="https://github.com/theodox" target="_blank"><i class="fa fa-github"></i></a></li>
        <li><a class="sc-google" href="https://plus.google.com/u/0/+SteveTheodore480BC/posts" target="_blank"><i class="fa fa-google"></i></a></li>
        <li><a class="sc-stack-overflow" href="http://stackoverflow.com/users/1936075/theodox" target="_blank"><i class="fa fa-stack-overflow"></i></a></li>
      </ul>

    <nav>
<!---if pages or LINKS -->


        <div>
          <h3 class="tagcloud_header">SUBJECTS</h3>
        </div>
        <ul class="tagcloud">
            <li class="tag-3">
                <a href="https://theodox.github.io/tag/animation.html">
                animation
                        <span class="badge">(3)</span>
                </a>
            </li>
            <li class="tag-3">
                <a href="https://theodox.github.io/tag/api.html">
                api
                        <span class="badge">(3)</span>
                </a>
            </li>
            <li class="tag-3">
                <a href="https://theodox.github.io/tag/articles.html">
                articles
                        <span class="badge">(2)</span>
                </a>
            </li>
            <li class="tag-2">
                <a href="https://theodox.github.io/tag/blog.html">
                blog
                        <span class="badge">(4)</span>
                </a>
            </li>
            <li class="tag-3">
                <a href="https://theodox.github.io/tag/blogging.html">
                blogging
                        <span class="badge">(3)</span>
                </a>
            </li>
            <li class="tag-3">
                <a href="https://theodox.github.io/tag/boo.html">
                boo
                        <span class="badge">(3)</span>
                </a>
            </li>
            <li class="tag-2">
                <a href="https://theodox.github.io/tag/books.html">
                books
                        <span class="badge">(5)</span>
                </a>
            </li>
            <li class="tag-2">
                <a href="https://theodox.github.io/tag/bugs.html">
                bugs
                        <span class="badge">(5)</span>
                </a>
            </li>
            <li class="tag-2">
                <a href="https://theodox.github.io/tag/cg.html">
                cg
                        <span class="badge">(8)</span>
                </a>
            </li>
            <li class="tag-3">
                <a href="https://theodox.github.io/tag/distribution.html">
                distribution
                        <span class="badge">(3)</span>
                </a>
            </li>
            <li class="tag-2">
                <a href="https://theodox.github.io/tag/games.html">
                games
                        <span class="badge">(9)</span>
                </a>
            </li>
            <li class="tag-2">
                <a href="https://theodox.github.io/tag/gdc.html">
                gdc
                        <span class="badge">(12)</span>
                </a>
            </li>
            <li class="tag-3">
                <a href="https://theodox.github.io/tag/graphics.html">
                graphics
                        <span class="badge">(2)</span>
                </a>
            </li>
            <li class="tag-2">
                <a href="https://theodox.github.io/tag/gui.html">
                gui
                        <span class="badge">(7)</span>
                </a>
            </li>
            <li class="tag-1">
                <a href="https://theodox.github.io/tag/industry.html">
                industry
                        <span class="badge">(33)</span>
                </a>
            </li>
            <li class="tag-3">
                <a href="https://theodox.github.io/tag/jobs.html">
                jobs
                        <span class="badge">(2)</span>
                </a>
            </li>
            <li class="tag-3">
                <a href="https://theodox.github.io/tag/markdown.html">
                markdown
                        <span class="badge">(3)</span>
                </a>
            </li>
            <li class="tag-2">
                <a href="https://theodox.github.io/tag/math.html">
                math
                        <span class="badge">(5)</span>
                </a>
            </li>
            <li class="tag-1">
                <a href="https://theodox.github.io/tag/maya.html">
                maya
                        <span class="badge">(45)</span>
                </a>
            </li>
            <li class="tag-2">
                <a href="https://theodox.github.io/tag/mgui.html">
                mgui
                        <span class="badge">(10)</span>
                </a>
            </li>
            <li class="tag-3">
                <a href="https://theodox.github.io/tag/minq.html">
                minq
                        <span class="badge">(2)</span>
                </a>
            </li>
            <li class="tag-3">
                <a href="https://theodox.github.io/tag/modeling.html">
                modeling
                        <span class="badge">(2)</span>
                </a>
            </li>
            <li class="tag-3">
                <a href="https://theodox.github.io/tag/modules.html">
                modules
                        <span class="badge">(3)</span>
                </a>
            </li>
            <li class="tag-3">
                <a href="https://theodox.github.io/tag/moonrise.html">
                moonrise
                        <span class="badge">(2)</span>
                </a>
            </li>
            <li class="tag-3">
                <a href="https://theodox.github.io/tag/pipeline.html">
                pipeline
                        <span class="badge">(2)</span>
                </a>
            </li>
            <li class="tag-1">
                <a href="https://theodox.github.io/tag/programming.html">
                programming
                        <span class="badge">(36)</span>
                </a>
            </li>
            <li class="tag-1">
                <a href="https://theodox.github.io/tag/python.html">
                python
                        <span class="badge">(47)</span>
                </a>
            </li>
            <li class="tag-3">
                <a href="https://theodox.github.io/tag/rigging.html">
                rigging
                        <span class="badge">(2)</span>
                </a>
            </li>
            <li class="tag-3">
                <a href="https://theodox.github.io/tag/sfx.html">
                sfx
                        <span class="badge">(2)</span>
                </a>
            </li>
            <li class="tag-1">
                <a href="https://theodox.github.io/tag/techart.html">
                techart
                        <span class="badge">(20)</span>
                </a>
            </li>
            <li class="tag-1">
                <a href="https://theodox.github.io/tag/tools.html">
                tools
                        <span class="badge">(16)</span>
                </a>
            </li>
            <li class="tag-2">
                <a href="https://theodox.github.io/tag/unity.html">
                unity
                        <span class="badge">(4)</span>
                </a>
            </li>
            <li class="tag-2">
                <a href="https://theodox.github.io/tag/web.html">
                web
                        <span class="badge">(6)</span>
                </a>
            </li>
      </ul>
      </nav>
    </div>


  </aside>
  <main>

    <nav>
      <a href="https://theodox.github.io">    Home
</a>

      <a href="/about">About...</a>
      <a href="/pages/pub">Publications</a>
      <a href="/pages/cookbook">Cookbook</a>
      <a href="/archives">By date</a>
      <a href="/tags">By subject</a>

      <a href="https://theodox.github.io/feeds/atom.xml">    Atom
</a>

      <a href="https://theodox.github.io/feeds/rss.xml">    RSS
</a>
    </nav>

<article class="single">
  <header>
      
    <h1 id="maya_callbacks_cheat_sheet">Maya callbacks cheat&nbsp;sheet</h1>
    <p>
          Posted on Wed 23 April 2014 in <a href="https://theodox.github.io/category/blog.html">blog</a>


    </p>
  </header>


  <div>
    <blockquote>
<p>Update 5/7/14: Added a note on closures and&nbsp;lambdas_  </p>
</blockquote>
<p>In <a href="all_your_base.html">All Your Base Classes</a>,  I suggested that we can do better than the standard callback mechanism for doing Maya event handling.  The limitations of the default method are something I&#8217;ve <a href="pity_for_the_outcast.html">complained about before</a>, and if you follow these things on <a href="http://tech-artists.org/forum/showthread.php?3292-Maya-python-UI-acessing-controls-from-external-functions"><span class="caps">TAO</span></a> or CGTalk or <a href="http://stackoverflow.com/questions/3435128/creating-a-ui-in-Maya-using-python-scripting">StackOverflow</a> it seems pretty clear that a lot of other people have problems with the standard Maya code flow&nbsp;too.  </p>
<p>I was planning on devoting the next big post to the event mechanism in <a href="https://github.com/theodox/mGUI">mGUI </a>. However as I did the spadework for this post I decided it was better to split it up into two parts, since a lot of folks seem to be confused about the right way to manage basic Maya callbacks. Before moving fancy stuff, it&#8217;s a good idea to make sure the basics are clear. Most vets will already know most of what I&#8217;m going over here, but I found the  time spent laying it out for myself a useful exercise  so I figured it would be worth sharing even if it&#8217;s not&nbsp;revolutionary.  </p>
<h2>Unsolved Mysteries of the&nbsp;Maya.</h2>
<p>So, let&#8217;s start by clearing up something that even a lot of old-school Maya coders find a bit mysterious when building&nbsp;GUIs.  </p>
<p><a href="http://epGUIdes.com/UnsolvedMysteries/cast.jpg"><img alt="" src="http://epGUIdes.com/UnsolvedMysteries/cast.jpg"></a></p>
<p>In vanilla Maya, <span class="caps">GUI</span> components fire callbacks - that is to say that when Maya recognizes a user action like a button press or a text entry, it calls a function you&#8217;ve provided. There are two ways you can set this up.  The old-school <span class="caps">MEL</span> way is to use a&nbsp;string:  </p>
<div class="highlight"><pre><span></span><span class="n">my_button</span> <span class="o">=</span> <span class="n">cmds</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="n">command</span> <span class="o">=</span> <span class="s1">&#39;print &quot;hello&quot;&#39;</span><span class="p">)</span>
</pre></div>


<p>In the bad old days of <span class="caps">MEL</span>, this was usually fine since most procedures were declared as globals and so they were available&nbsp;everywhere.  </p>
<p>Unfortunately, Python&#8217;s stricter rules about scoping mean that you constantly run into problems with this strategy if you&#8217;re not careful. For example, this straight python conversion of the Mel paradigm works&nbsp;fine:  </p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">print_hello</span><span class="p">(</span><span class="n">_</span><span class="p">):</span>  
    <span class="k">print</span> <span class="s2">&quot;hello&quot;</span>

<span class="n">my_w</span> <span class="o">=</span> <span class="n">cmds</span><span class="o">.</span><span class="n">window</span><span class="p">()</span>  
<span class="n">my_col</span> <span class="o">=</span> <span class="n">cmds</span><span class="o">.</span><span class="n">columnLayout</span><span class="p">()</span>  
<span class="n">my_button</span> <span class="o">=</span> <span class="n">cmds</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;print_hello()&quot;</span><span class="p">)</span>  
<span class="n">cmds</span><span class="o">.</span><span class="n">showWindow</span><span class="p">(</span><span class="n">my_w</span><span class="p">)</span>
</pre></div>


<p>But try&nbsp;this:  </p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">show_test_window</span><span class="p">():</span>  
    <span class="k">def</span> <span class="nf">print_hello_again</span><span class="p">(</span><span class="n">_</span><span class="p">):</span>  
        <span class="k">print</span> <span class="s2">&quot;hello&quot;</span>

    <span class="n">my_w</span> <span class="o">=</span> <span class="n">cmds</span><span class="o">.</span><span class="n">window</span><span class="p">()</span>  
    <span class="n">my_col</span> <span class="o">=</span> <span class="n">cmds</span><span class="o">.</span><span class="n">columnLayout</span><span class="p">()</span>  
    <span class="n">my_button</span> <span class="o">=</span> <span class="n">cmds</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;print_hello_again()&quot;</span><span class="p">)</span>  
    <span class="n">cmds</span><span class="o">.</span><span class="n">showWindow</span><span class="p">(</span><span class="n">my_w</span><span class="p">)</span>

<span class="n">show_test_window</span><span class="p">()</span>
</pre></div>


<p>When you hit the button you&#8217;ll be&nbsp;told  </p>
<div class="highlight"><pre><span></span><span class="c1"># Error: NameError: name &#39;print_hello_again&#39; is not defined #</span>
</pre></div>


<p>That&#8217;s because <code>print_hello_again</code> is defined in the scope of the <em>function</em>, not the scope of the Maya interpreter &#8212; when the callback actually fires, the name is buried away inside of _show_test_window _and can&#8217;t be found by Maya, at least not using the simple string&nbsp;name.</p>
<blockquote>
<p>That &#8220;_&#8221; in the functions, by the way, is the standard python symbol for &#8220;I have to have a variable here but I intend to ignore it&#8221; - it shows up in a lot of these <span class="caps">GUI</span> examples because many, though not all, Maya callbacks fire off an argument when they&nbsp;activate.   </p>
</blockquote>
<p>This happens all the time to people trying to port old <span class="caps">MEL</span> code to Python - snippets that work in the interpreter don&#8217;t work when converted to functions or split between modules because the string callbacks only execute in the global scope. Luckily, once you realize that the &#8220;where is my function&#8221; problem is just basic scoping, it&#8217;s easy to fix. You can forcibly capture the functions you want by just passing them directly to your <span class="caps">GUI</span> callbacks instead of using strings, thanks to the magic of python&#8217;s <a href="http://python-history.blogspot.com/2009/02/first-class-everything.html">first class functions</a>.  You just need to pass the function itself - not a quoted string that looks like the function - to the callback, Thus the previous example&nbsp;becomes</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">show_test_window</span><span class="p">():</span>  
    <span class="k">def</span> <span class="nf">print_hello_again</span><span class="p">(</span><span class="n">_</span><span class="p">):</span>  
        <span class="k">print</span> <span class="s2">&quot;hello&quot;</span>

    <span class="n">my_w</span> <span class="o">=</span> <span class="n">cmds</span><span class="o">.</span><span class="n">window</span><span class="p">()</span>  
    <span class="n">my_col</span> <span class="o">=</span> <span class="n">cmds</span><span class="o">.</span><span class="n">columnLayout</span><span class="p">()</span>  
    <span class="n">my_button</span> <span class="o">=</span> <span class="n">cmds</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="n">command</span> <span class="o">=</span> <span class="n">print_hello_again</span><span class="p">)</span>  
    <span class="c1"># note: no quotes and no parens. </span>
    <span class="c1"># You&#39;re passing the function as an object!  </span>
    <span class="n">cmds</span><span class="o">.</span><span class="n">showWindow</span><span class="p">(</span><span class="n">my_w</span><span class="p">)</span>

<span class="n">show_test_window</span><span class="p">()</span>
</pre></div>


<p>Since you&#8217;ve got the callback in scope when you create the <span class="caps">GUI</span>, you&#8217;re certain to have it when you need it (if by some accident it was out of scope at creation time you&#8217;d get an obvious error that you&#8217;d have to fix before moving&nbsp;on).  </p>
<p>Clear, predictable scoping is why it&#8217;s almost always the right decision to wrap your GUIs in classes. The class defines a predictable scope so you don&#8217;t  have to worry about what&#8217;s loaded or try to cram import statements into your callback functions.   Plus, classes include data storage, so you can keep your data nicely independent of your code. Suppose, for example, you needed to display a different set of greetings beyond the standard &#8220;hello world.&#8221;  With a class you can defer the problem up to the moment of the actual button press with no fancy footwork or complex lambda&nbsp;management:  </p>
<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Greeter</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>  
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">greeting</span><span class="p">):</span>  
        <span class="bp">self</span><span class="o">.</span><span class="n">greeting</span> <span class="o">=</span> <span class="n">greeting</span>  
        <span class="bp">self</span><span class="o">.</span><span class="n">window</span> <span class="o">=</span> <span class="n">cmds</span><span class="o">.</span><span class="n">window</span><span class="p">()</span>  
        <span class="n">cmds</span><span class="o">.</span><span class="n">columnLayout</span><span class="p">()</span>  
        <span class="n">cmds</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="n">command</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">greet</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  
            <span class="n">cmds</span><span class="o">.</span><span class="n">showWindow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">window</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">greet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_</span><span class="p">):</span>  
            <span class="k">print</span> <span class="bp">self</span><span class="o">.</span><span class="n">greeting</span>
</pre></div>


<p>Whatever is stuffed into the Greeter&#8217;s <em>greeting</em> field will be printed out when the button get&#8217;s&nbsp;pressed.  </p>
<h2>Lambda Lambda&nbsp;Lambda</h2>
<p>Of course, sometimes you don&#8217;t need a full blown class for your callback functions; often you just want to do something simple that doesn&#8217;t deserve a full function of it&#8217;s own.  In cases like this, python provides a handy construct called a <em>lambda</em>, which is basically a one-line function.  A lambda looks like&nbsp;this:  </p>
<div class="highlight"><pre><span></span><span class="n">multiply</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="p">:</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span>
</pre></div>


<p>which is exactly equivalent&nbsp;to:  </p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">multiply</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>  
    <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span>
</pre></div>


<p>In this example &#8216;multiply&#8217; is just a plain old variable name. x and y are the input variables, and the expression to the right of the colon is what the lambda returns.  Lambdas can have any number of arguments, but they don&#8217;t use the <em>args / </em>*kwargs variable argument&nbsp;syntax.   </p>
<p>The main difference between  lambdas and functions  is that the body of a lambda is a single expression : you can&#8217;t put flow control (such as loops) or statements which are not evaluable (such as &#8216;print&#8217; ) into a lambda.  You can, however, call functions - even functions that return&nbsp;None.  </p>
<p>Lambdas are a great way to  cook up throwaway functions. For&nbsp;example:  </p>
<div class="highlight"><pre><span></span><span class="n">w</span> <span class="o">=</span> <span class="n">cmds</span><span class="o">.</span><span class="n">window</span><span class="p">()</span>  
<span class="n">cmds</span><span class="o">.</span><span class="n">columnLayout</span><span class="p">()</span>  
<span class="n">cmd</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="s1">&#39;cube&#39;</span><span class="p">,</span> <span class="n">command</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">cmds</span><span class="o">.</span><span class="n">polyCube</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;new_cube&#39;</span><span class="p">))</span>  
<span class="n">cmds</span><span class="o">.</span><span class="n">showWindow</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
</pre></div>


<p>creates a window with a button which creates a cube when the button is pressed.  You&#8217;ll probably note that in this case the argument to the lambda is ignored - that&#8217;s because buttons always fire their callbacks with one argument so the lambda needs to accept&nbsp;one.</p>
<blockquote>
<p>In other examples, you&#8217;ll recall, I use  a python convention of a single underscore as the &#8216;ignore me&#8217;&nbsp;argument.</p>
</blockquote>
<p>The one thing that makes lambdas interesting (sometimes the &#8216;<em>may you live in interesting times</em>&#8216; sort of interesting) is that they are inside the scope of your functions - which means they can use <a href="http://www.shutupandship.com/2012/01/python-closures-explained.html">closures</a> to capture variables <em>before</em> they fire.  This can be useful if you want to set up a simple relationship without building a full-on class. This example sets the text of a text widget based on a value you pass it at startup, showing the way closures capture&nbsp;names:  </p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">closure_example_window</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>  
    <span class="n">w</span> <span class="o">=</span> <span class="n">cmds</span><span class="o">.</span><span class="n">window</span><span class="p">()</span>  
    <span class="n">c</span> <span class="o">=</span> <span class="n">cmds</span><span class="o">.</span><span class="n">columnLayout</span><span class="p">()</span>  
    <span class="n">t</span> <span class="o">=</span> <span class="n">cmds</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;press the button&#39;</span><span class="p">)</span>  
    <span class="n">cmd</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="s1">&#39;cube&#39;</span><span class="p">,</span>  <span class="n">c</span><span class="o">=</span> <span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="n">cmds</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="n">value</span><span class="p">))</span>  
    <span class="c1"># captures the name of the text and the value passed in by the user  </span>
    <span class="n">cmds</span><span class="o">.</span><span class="n">showWindow</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
</pre></div>


<p>However, closures are automatically created by Python when a given scope is closed up - in this example, that would be at the end of the function. The values that are &#8216;closed over&#8217; are determined when the function finishes.  Which is usually what you want&#8230; unless you&#8217;re in the habit of re-using variable&nbsp;names:  </p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">closure_example_surprise</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>  
    <span class="n">w</span> <span class="o">=</span> <span class="n">cmds</span><span class="o">.</span><span class="n">window</span><span class="p">()</span>  
    <span class="n">c</span> <span class="o">=</span> <span class="n">cmds</span><span class="o">.</span><span class="n">columnLayout</span><span class="p">()</span>  
    <span class="n">t</span> <span class="o">=</span> <span class="n">cmds</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;press the button&#39;</span><span class="p">)</span>  
    <span class="n">cmd</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="s1">&#39;cube&#39;</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="n">cmds</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="n">value</span><span class="p">))</span>  
    <span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;gotcha!&#39;</span>  
    <span class="n">cmds</span><span class="o">.</span><span class="n">showWindow</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
</pre></div>


<p>When you run this one, the button ignores your value and prints <code>gotcha</code> instead of whatever value you passed in! That&#8217;s because the closure will get its value when the function finishes in line 7, <span class="caps">NOT</span> when you first assign it in line 5. This little gotcha is usually a curiosity, but it makes life difficult if you want to, say, assign commands inside a loop. In a case like that you should use functions or callable objects (see below) in preference to&nbsp;lambdas. </p>
<h2>Arguments for the&nbsp;prosecution</h2>
<p>So, the &#8220;where the hell is my function&#8221; problem which tends to plague beginners is easy to solve once you look at it the right&nbsp;way.   </p>
<p>However, right after you&#8217;re comfortable with passing functions directly, you immediately realize that&#8217;s not enough.  It&#8217;s very common to have multiple <span class="caps">GUI</span> controls that do more or less the same thing with different settings such a set of buttons which make different sized&nbsp;objects.    </p>
<p>Alas, while this is easy to understand, it&#8217;s also kinda ugly to&nbsp;code.  </p>
<p>For starters, you might try making lots of little&nbsp;functions:  </p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">Boxes</span><span class="p">():</span>  
    <span class="k">def</span> <span class="nf">make_big_box</span><span class="p">(</span><span class="n">_</span><span class="p">):</span>  
        <span class="n">cmds</span><span class="o">.</span><span class="n">polyCube</span><span class="p">(</span><span class="n">h</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">make_med_box</span><span class="p">(</span><span class="n">_</span><span class="p">):</span>  
        <span class="n">cmds</span><span class="o">.</span><span class="n">polyCube</span><span class="p">(</span><span class="n">h</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">make_sm_box</span><span class="p">(</span><span class="n">_</span><span class="p">):</span>  
        <span class="n">cmds</span><span class="o">.</span><span class="n">polyCube</span><span class="p">(</span><span class="n">h</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="n">my_w</span> <span class="o">=</span> <span class="n">cmds</span><span class="o">.</span><span class="n">window</span><span class="p">()</span>  
    <span class="n">cmds</span><span class="o">.</span><span class="n">columnLayout</span><span class="p">()</span>  
    <span class="n">cmds</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="s2">&quot;small box&quot;</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">make_sm_box</span><span class="p">)</span>  
    <span class="n">cmds</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="s2">&quot;medium box&quot;</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">make_med_box</span><span class="p">)</span>  
    <span class="n">cmds</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="s2">&quot;large box&quot;</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">make_big_box</span><span class="p">)</span>  
    <span class="n">cmds</span><span class="o">.</span><span class="n">showWindow</span><span class="p">(</span><span class="n">my_w</span><span class="p">)</span>
</pre></div>


<p>Or you could do basically the same thing using lambdas to create temporary functions, which saves on the extra defs but tends to be illegible and tough to debug for complex commands&nbsp;:  </p>
<div class="highlight"><pre><span></span>    def BoxLambdas():  
        my_w = cmds.window()  
        cmds.columnLayout()  
        cmds.button(&quot;small box&quot;, c = lambda _: cmds.polyCube(d =2, w= 2 , h=2) )  
        cmds.button(&quot;medium box&quot;,  c = lambda _: cmds.polyCube(d = 10 , w = 5 , h = 5) )  
        cmds.button(&quot;large box&quot;, c = lambda _: cmds.polyCube(d = 10 , w = 10 , h = 10) )  
        cmds.showWindow(my_w)
</pre></div>


<p><em><span class="caps">BTW</span> There&#8217;s that underscore again, in the lambdas, doing the same job: ignoring the callback argument from the buttons</em>.</p>
<p>A third method is to use the Python built-in module <code>functools</code>. Functools offsers the <a href="https://docs.python.org/2/library/functools.html#functools.partial"><code>partial</code> object</a>, which &#8220;freezes&#8221; a command and a set of arguments into a callable&nbsp;package.   </p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>  
<span class="k">def</span> <span class="nf">FuncBoxes</span><span class="p">():</span>

    <span class="c1"># note the comma - the command is an argument to partial!   </span>
    <span class="n">small_box</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span> <span class="n">cmds</span><span class="o">.</span><span class="n">polyCube</span><span class="p">,</span>   <span class="n">d</span> <span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="mi">2</span> <span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="mi">2</span> <span class="p">)</span>  
    <span class="n">med_box</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span> <span class="n">cmds</span><span class="o">.</span><span class="n">polyCube</span><span class="p">,</span>  <span class="n">d</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="mi">5</span> <span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="mi">5</span> <span class="p">)</span>  
    <span class="n">big_box</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span> <span class="n">cmds</span><span class="o">.</span><span class="n">polyCube</span><span class="p">,</span>  <span class="n">d</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="mi">10</span> <span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="mi">10</span> <span class="p">)</span>

    <span class="n">my_w</span> <span class="o">=</span> <span class="n">cmds</span><span class="o">.</span><span class="n">window</span><span class="p">()</span>  
    <span class="n">cmds</span><span class="o">.</span><span class="n">columnLayout</span><span class="p">()</span>  
    <span class="n">cmds</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="s2">&quot;small box&quot;</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">_</span> <span class="p">:</span> <span class="n">small_box</span><span class="p">())</span>  
    <span class="n">cmds</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="s2">&quot;medium box&quot;</span><span class="p">,</span>  <span class="n">c</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">_</span> <span class="p">:</span> <span class="n">med_box</span><span class="p">()</span> <span class="p">)</span>  
    <span class="n">cmds</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="s2">&quot;large box&quot;</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">_</span> <span class="p">:</span> <span class="n">big_box</span><span class="p">()</span>  <span class="p">)</span>  
    <span class="n">cmds</span><span class="o">.</span><span class="n">showWindow</span><span class="p">(</span><span class="n">my_w</span><span class="p">)</span>
</pre></div>


<p>Partials are handy for cleaning up the messes you&#8217;d get from trying to format a complex commands in-line in the middle of your <span class="caps">GUI</span> code. This example is a sort of worst case scenario, since Maya buttons always fire with a single argument and cmds.polyCube doesn&#8217;t like that.  Here I used lambdas  to swallow the arguments (note the telltale underscores). More often you&#8217;ll be calling your own functions and the syntax is much cleaner and easier to&nbsp;parse:</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>  
<span class="k">def</span> <span class="nf">FuncBoxesClean</span><span class="p">():</span>  
    <span class="k">def</span> <span class="nf">make_box</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>    
       <span class="c1"># swallow the argument but keep the keywords...</span>
       <span class="n">cmds</span><span class="o">.</span><span class="n">polyCube</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="n">small_box</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span> <span class="n">make_box</span><span class="p">,</span>   <span class="n">d</span> <span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="mi">2</span> <span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="mi">2</span> <span class="p">)</span>  
    <span class="n">med_box</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span> <span class="n">make_box</span><span class="p">,</span>  <span class="n">d</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="mi">5</span> <span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="mi">5</span> <span class="p">)</span>  
    <span class="n">big_box</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span> <span class="n">make_box</span><span class="p">,</span>  <span class="n">d</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="mi">10</span> <span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="mi">10</span> <span class="p">)</span>

    <span class="n">my_w</span> <span class="o">=</span> <span class="n">cmds</span><span class="o">.</span><span class="n">window</span><span class="p">()</span>  
    <span class="n">cmds</span><span class="o">.</span><span class="n">columnLayout</span><span class="p">()</span>  
    <span class="n">cmds</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="s2">&quot;small box&quot;</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span>  <span class="n">small_box</span><span class="p">)</span>  
    <span class="n">cmds</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="s2">&quot;medium box&quot;</span><span class="p">,</span>  <span class="n">c</span> <span class="o">=</span> <span class="n">med_box</span> <span class="p">)</span>  
    <span class="n">cmds</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="s2">&quot;large box&quot;</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">big_box</span>  <span class="p">)</span>  
    <span class="n">cmds</span><span class="o">.</span><span class="n">showWindow</span><span class="p">(</span><span class="n">my_w</span><span class="p">)</span>
</pre></div>


<p>That&#8217;s far easier on the eyes and less of a nasty tax on future readers, but it requires a knowledge of how partials&nbsp;work.</p>
<h2>Final&nbsp;Summation</h2>
<p>So, here&#8217;s a cheatsheet of the rules for hooking Maya event&nbsp;callbacks:  </p>
<ol>
<li>Don&#8217;t use strings for python calls. <ol>
<li>If you&#8217;re calling <span class="caps">MEL</span>, <span class="caps">OK</span>: but don&#8217;t use <span class="caps">MEL</span> anyway&nbsp;:)</li>
</ol>
</li>
<li>Pass functions to your callback directly. No quotes, no parens.<ol>
<li>If you have a scope problem, you&#8217;ll see it when you create the <span class="caps">GUI</span>; usually you can solve it with an&nbsp;import</li>
</ol>
</li>
<li>If you need to pass arguments to your function in the callback, you have options:<ol>
<li>custom mini-functions are clear, but extra&nbsp;work</li>
<li>lambdas are ugly, but&nbsp;workable</li>
<li>partials - especially on top of your own functions - are&nbsp;clean </li>
</ol>
</li>
</ol>
<p>Now, even if you follow these rules,  its easy for your functional code and your <span class="caps">GUI</span> to get in each other&#8217;s ways.  Creating a lot of throwaway functions is busywork, but formatting commands in-line inside <span class="caps">GUI</span> code is error prone and hard to read. Partials are nice for separating data from layout code, but usually come with annoying extra syntax to hide the callback&nbsp;arguments.  </p>
<h3>Next&nbsp;Episode&#8230;</h3>
<p>Of course if you&#8217;ve been following the <a href="https://github.com/theodox/mGUI">mGUI</a>series you&#8217;ll know where I&#8217;m going. (If you haven&#8217;t, you might want to check <a href="pity_for_the_outcast.html">here</a>, <a href="rescuing_maya_gui_from_itself.html">here </a>and <a href="all_your_base.html">here</a> before continuing).  Next time out I&#8217;lll take a look at how you could get to a cleaner separation of concerns like&nbsp;this:  </p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mGUI.GUI</span> <span class="kn">as</span> <span class="nn">mg</span>

<span class="k">def</span> <span class="nf">make_box</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>  
    <span class="n">H</span><span class="p">,</span><span class="n">W</span><span class="p">,</span><span class="n">D</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;sender&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">Tag</span>  
    <span class="n">cmds</span><span class="o">.</span><span class="n">polyCube</span><span class="p">(</span><span class="n">h</span> <span class="o">=</span> <span class="n">H</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">D</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">W</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">mGUIBoxes</span><span class="p">():</span>  
    <span class="k">with</span> <span class="n">mg</span><span class="o">.</span><span class="n">Window</span><span class="p">(</span><span class="s2">&quot;boxes&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">window</span><span class="p">:</span>  
        <span class="k">with</span> <span class="n">mg</span><span class="o">.</span><span class="n">ColumnLayout</span><span class="p">(</span><span class="s2">&quot;col&quot;</span><span class="p">):</span>  
            <span class="n">mg</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="s2">&quot;sm&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;small boxes&quot;</span><span class="p">,</span> <span class="n">tag</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="p">)</span>  
            <span class="n">mg</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="s2">&quot;med&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;medium boxes&quot;</span><span class="p">,</span> <span class="n">tag</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span> <span class="p">)</span>  
            <span class="n">mg</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="s2">&quot;lrg&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;large boxes&quot;</span><span class="p">,</span> <span class="n">tag</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span> <span class="p">)</span>

    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">window</span><span class="o">.</span><span class="n">col</span><span class="o">.</span><span class="n">Controls</span><span class="p">:</span>  
        <span class="n">b</span><span class="o">.</span><span class="n">command</span> <span class="o">+=</span> <span class="n">make_box</span>  
    <span class="n">window</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="https://theodox.github.io/tag/maya.html">Maya</a>
      <a href="https://theodox.github.io/tag/gui.html">GUI</a>
      <a href="https://theodox.github.io/tag/python.html">python</a>
      <a href="https://theodox.github.io/tag/programming.html">programming</a>
    </p>
  </div>

  <div class="center social-share">
    <p>    Like this article? Share it with your friends!
</p>
    <div class="addthis_native_toolbox"></div>
    <div class="addthis_sharing_toolbox"></div>
    <div class="addthis_inline_share_toolbox"></div>
  </div>


    <div class="addthis_relatedposts_inline"></div>


<!-- Disqus -->
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'theodoxcom';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>
        Please enable JavaScript to view comments.

</noscript>
<!-- End Disqus -->
</article>

    <footer>
<p>&copy;  2018</p>
<p>    Powered by <a href="http://getpelican.com" target="_blank">Pelican</a> - <a href="https://github.com/alexandrevicenzi/flex" target="_blank">Flex</a> theme by <a href="http://alexandrevicenzi.com" target="_blank">Alexandre Vicenzi</a>
</p>    </footer>
  </main>


    <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-575daf41c4afb207" async="async"></script>


<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Chimeras & Manticores ",
  "url" : "https://theodox.github.io",
  "image": "",
  "description": ""
}
</script>

</body>
</html>