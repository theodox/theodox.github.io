<!DOCTYPE html>
<html lang="en">
<head>
        <title>Good&nbsp;tricks</title>
        <meta charset="utf-8" />
        <link href="http://theodox.com/feeds/atom.xml" type="application/atom+xml" rel="alternate" title="Chimeras & Manticores Full Atom Feed" />
        <link href="http://theodox.com/feeds/rss.xml" type="application/rss+xml" rel="alternate" title="Chimeras & Manticores Full RSS Feed" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="http://theodox.com/">Chimeras & Manticores <strong>technical art, python, the games business, and obscurantism</strong></a></h1>
        </header><!-- /#banner -->
        <nav id="menu"><ul>
            <li><a href="/about">About...</a></li>
            <li><a href="/pages/pub">Publications</a></li>
            <li><a href="http://astore.amazon.com/tecsurgui-20">Tech-Art Book Store</a></li>
            <li><a href="/pages/cookbook">Cookbook</a></li>
        </ul></nav><!-- /#menu -->
    <h1>Good&nbsp;tricks</h1>
    

    <p>This page is a collection of little bits of useful info that are too small to merit their own blog posts.  They aren&#8217;t in any particular order but they can be very&nbsp;useful.</p>
<hr />
<h2>itertools is your&nbsp;friend</h2>
<p>The itertools module is a bit of Python arcana that many people overlook.  For an in-depth look , <a href="http://pymotw.com/2/itertools/index.html">Doug Hellman&#8217;s PyMOTW article</a> is a great overview.. Here are some of the&nbsp;highlights:</p>
<p><strong>itertools.chain</strong> is a fast way to string a list of iterables together. For example, you might have a list of lists - say, a bunch of component selections in Maya - and want to combine them into a single list.  It creates a generator that you can run through one item at a time or convert to a list with a list&nbsp;comprehension   </p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">itertools</span>  
<span class="n">cube_verts</span> <span class="o">=</span>  <span class="p">[</span><span class="s1">&#39;pCube1.vtx[1]&#39;</span><span class="p">,</span> <span class="s1">&#39;pCube1.vtx[2]&#39;</span><span class="p">,</span> <span class="s1">&#39;pCube1.vtx[4]&#39;</span><span class="p">,</span> <span class="s1">&#39;pCube1.vtx[5]&#39;</span><span class="p">]</span>  
<span class="n">sphere_verts</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;pSphere1.vtx[10]&#39;</span><span class="p">,</span> <span class="s1">&#39;pSphere1.vtx[11]&#39;</span><span class="p">,</span> <span class="s1">&#39;pSphere1.vtx[12]&#39;</span><span class="p">,</span> <span class="s1">&#39;pSphere1.vtx[99]&#39;</span><span class="p">]</span>  
<span class="n">plane_verts</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;pPlane1.vtx[2]&#39;</span><span class="p">,</span> <span class="s1">&#39;pPlane1.vtx[20]&#39;</span><span class="p">,</span> <span class="s1">&#39;pPlane1.vtx[200]&#39;</span><span class="p">,</span> <span class="s1">&#39;pPlane1.vtx[202]&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="n">cube_verts</span><span class="p">,</span> <span class="n">sphere_verts</span><span class="p">,</span> <span class="n">plane_verts</span><span class="p">):</span>  
    <span class="k">print</span> <span class="n">item</span>

<span class="c1">#pCube1.vtx[1]  </span>
<span class="c1">#pCube1.vtx[2]  </span>
<span class="c1">#pCube1.vtx[4]  </span>
<span class="c1">#pCube1.vtx[5]  </span>
<span class="c1">#pSphere1.vtx[10]  </span>
<span class="c1">#pSphere1.vtx[11]  </span>
<span class="c1">#pSphere1.vtx[12]  </span>
<span class="c1">#pSphere1.vtx[99]  </span>
<span class="c1">#pPlane1.vtx[2]  </span>
<span class="c1">#pPlane1.vtx[20]  </span>
<span class="c1">#pPlane1.vtx[200]  </span>
<span class="c1">#pPlane1.vtx[202]</span>
</pre></div>


<p><strong>itertools.product</strong> will give you a generator that produces all the combinations of multiple iterable items. For&nbsp;example:  </p>
<div class="highlight"><pre><span></span>axes = (&#39;x&#39;, &#39;y&#39;, &#39;z&#39;)  
dimensions = (-1, 0, 1)  
print [i for i in itertools.product(axes, dimensions)]  
# [(&#39;x&#39;, -1), (&#39;x&#39;, 0), (&#39;x&#39;, 1), (&#39;y&#39;, -1), (&#39;y&#39;, 0), (&#39;y&#39;, 1), (&#39;z&#39;, -1), (&#39;z&#39;, 0), (&#39;z&#39;, 1)]
</pre></div>


<hr />
<h2>regex&nbsp;testers</h2>
<p>Regular aexpressions are powerful.  They are also ridiculous artifacts of the dark ages when superstitious programmers seemed to believe that every keystroke incurred the displeasure of the computing gods.  Figuring out a regex from scratch is all to often a frustrating exercise, so it&#8217;s great to have an interactive tool to let you experiment in a nice, safe environment instead of trying to write your regexes and your actual tools st the same&nbsp;time.</p>
<p>For Pythonista&#8217;s, try <a href="https://pythex.org/">Pythex</a>.</p>
<p>C# / dotnet programmers can use <a href="http://regexstorm.net/tester">Regex&nbsp;Storm</a> </p>
<hr />
<h2><strong>Maya list&nbsp;returns</strong></h2>
<p>Before maya 2014, cmds had several commands with an annoying, anti-pythonic behaviour: if you ask a question that usually returns a list but get no results, Maya will return <em>None</em> instead of an empty list. The most common example is a call to <em>cmds.ls</em> which returns&nbsp;nothing:  </p>
<div class="highlight"><pre><span></span>good_stuff = cmds.ls(type=&#39;mesh&#39;)  
for item in good_stuff:  
    do_something(item)  
# ERROR: NoneType is not iterable
</pre></div>


<p>Luckily, Python has a handy language feature that makes it easy to avoid this trap without an extra if test. If you change the ls like&nbsp;so:   </p>
<div class="highlight"><pre><span></span>good_stuff = cmds.ls(type=&#39;mesh&#39;) or []  
for item in good_stuff:  
    do_something(item)
</pre></div>


<p>The <code>or []</code> will pass a list result with something in it unchanged; but if the result is None, the or will substitute the empty list. Everything downstream from there can rely on the presence of a real list, even if it&#8217;s&nbsp;empty   </p>
<hr />
<h2>Maya-like selection-or-list&nbsp;behavior</h2>
<p>If you want to make a function that behaves like the default maya commands &#8212; that is, it works on arguments you pass or on selected objects &#8212; you can combine the *args variable input and the or [] trick to make a nice one liner&nbsp;:</p>
<div class="highlight"><pre><span></span>def mayalike(*args):  
     my_objects = args or cmds.ls(sl=True) or []  
     for item in my_objects:  
           #do stuff
</pre></div>


<p>This will use <code>args</code> if provided and the result of <code>cmds.ls(sl=True)</code> if not. Since the <code>or []</code> is at the end you can always iterate on it regardless of the arguments or the state of the Maya&nbsp;selection.</p>
<hr />
<h2>Python multiple&nbsp;assignment</h2>
<p>Python has a handy trick of unpacking iterables in a single assigment call.  This lets you write things&nbsp;like:</p>
<div class="highlight"><pre><span></span>rotation = [ 0, 90, 0 ]
rx, ry, rz = rotation
</pre></div>


<p>which saves some annoying boilderplate.  It can be especially useful when dealing with functions that produce tuple or list&nbsp;results:</p>
<div class="highlight"><pre><span></span>filename, extension = os.splitext(completefilename)
</pre></div>


<p>which is much more elegant&nbsp;than</p>
<div class="highlight"><pre><span></span>results = os.splitext(completefilename)
filename = results[0]
extension = results[1]
</pre></div>


<p>It&#8217;s a good idea, though, to resist the temptation to overdo it: if you find yourself unpacking long tuples a&nbsp;lot:</p>
<div class="highlight"><pre><span></span>name, address, state, zip, phone = customer
</pre></div>


<p>that&#8217;s a good sign that customer should be a dictionary, a class, or &#8212; best of all &#8212; a <a href="http://pymotw.com/2/collections/namedtuple.html"><code>namedtuple</code></a>so you can parse it&nbsp;reliably. </p>
<hr />
<h3>Learn to love&nbsp;Mayapy</h3>
<p>If you&#8217;re doing a lot of work that involves restarting and reloading maya - particularly if you&#8217;re iterating on one script that involves a bunch of setup work &#8212; the common trick is to keep all of your steps in a python tab in your listener.  It&#8217;s better than nothing, but it&#8217;s still pretty slow, since you need to start up Maya and wait for the gui to finish loading which takes several seconds at&nbsp;best. </p>
<p>If what you&#8217;re working on does not require <span class="caps">GUI</span> access, you can use MayaPy.exe and the <code>-c</code> and <code>-i</code> flags to get into your script quickly. The <code>-c</code> flag launches mayapy and runs a command, and the <code>-i</code> flag keeps the  interpreter running. So you can boot mayapy directly into a running, headless copy of maya python like&nbsp;this:  </p>
<div class="highlight"><pre><span></span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">maya</span><span class="o">.</span><span class="n">py</span><span class="o">.</span><span class="n">exe</span> <span class="o">-</span><span class="n">i</span> <span class="o">-</span><span class="n">c</span> <span class="s2">&quot;import maya.standalone; maya.standalone.initialize()&quot;</span>
</pre></div>


<p>Obviously you could put your test setup in a separate module and import that after standalone. I&#8217;ve found this saves me a <em>huge</em> amount of time when I&#8217;m iterating on something that doesn&#8217;t need <span class="caps">GUI</span>.  I stick this into a button in my <span class="caps">IDE</span> or make a shell alias / bat script to do&nbsp;it.  </p>
<hr />
<h2><a href="http://lesterbanks.com/2014/01/maya-using-transfer-attributes-as-a-shrink-wrap-deformer/">http://lesterbanks.com/2014/01/maya-using-transfer-attributes-as-a-shrink-wrap-deformer/</a></h2>

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>,
                which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->
        </footer><!-- /#contentinfo -->
</body>
</html>