<!DOCTYPE html>
<html lang="en">
<head>
        <title>Adding game&nbsp;logic</title>
        <meta charset="utf-8" />
        <link href="http://theodox.com/feeds/atom.xml" type="application/atom+xml" rel="alternate" title="Chimeras & Manticores Full Atom Feed" />
        <link href="http://theodox.com/feeds/rss.xml" type="application/rss+xml" rel="alternate" title="Chimeras & Manticores Full RSS Feed" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="http://theodox.com/">Chimeras & Manticores <strong>technical art, python, the games business, and obscurantism</strong></a></h1>
        </header><!-- /#banner -->
        <nav id="menu"><ul>
            <li><a href="/about">About...</a></li>
            <li><a href="/pages/pub">Publications</a></li>
            <li><a href="http://astore.amazon.com/tecsurgui-20">Tech-Art Book Store</a></li>
            <li><a href="/pages/cookbook">Cookbook</a></li>
        </ul></nav><!-- /#menu -->
    <h1>Adding game&nbsp;logic</h1>
    

    <p>At this point you can run the game and throw the ball, knocking pins&nbsp;over. </p>
<p>Unfortunately, you don&#8217;t have a way to play for long - the ball will fall off the end of the alley and disappear off screen. We need a way to tell the game to give you back the ball, just like the ball return in the bowling alley does. To do this we&#8217;re going to use a <a href="glossary#trigger">Trigger</a>.  </p>
<p>We&#8217;ll also take a brief peek at some script code &#8212; but don&#8217;t worry if it doesn&#8217;t make sense, for now we&#8217;re just providing some background. The focus of this tutorial is getting comfortable with the Unity way of assembling pieces, not&nbsp;programming.</p>
<ol>
<li>Select your alley and duplicate it (<strong>Ctrl+D</strong>)</li>
<li>Rename the duplicate object to&nbsp;&#8216;trigger&#8217;</li>
<li>Move the duplicate a couple of units below the alley so you can see&nbsp;it.</li>
<li>In the inspector, click on the little gear icon to the right of the <strong>MeshFilter</strong> component of the trigger.  Choose &#8216;Remove component&#8217;.<blockquote>
<p>MeshFilters are the components which control the geometry associated with a&nbsp;gameObject</p>
</blockquote>
</li>
<li>Do the same for the <strong>MeshRenderer</strong> component. The object will now appear as just a wireframe box. <blockquote>
<p>If you deselect it, the trigger will disappear. You can see it again by selecting it in the hierarchy window. Another reason why its good to be careful when you name parts of your&nbsp;scene!</p>
</blockquote>
</li>
<li>Scale the wireframe box up with the Scale tool (<strong>E</strong>) so that the top of the wireframe volume is just below the top surface of the alley and the wireframe extends a meter or two off every side:
  <p/><img alt="trigger" src="https://dl.dropboxusercontent.com/u/2977490/Unity%40makerhaus/gfx/Screenshot%202013-10-12%2022.03.46.png" /><blockquote>
<p>We want the box to be fairly deep, so a fast moving ball doesn&#8217;t shoot right through it without triggering a collision. We want it to cover all sides to catch gutter&nbsp;balls!</p>
</blockquote>
</li>
<li>Select the <strong>BoxCollider</strong> component of your trigger and check the <strong>IsTrigger</strong> checkbox.<blockquote>
<p>This tells the system that the volume is only for reporting collisions - but objects won&#8217;t bounce off&nbsp;it.</p>
</blockquote>
</li>
<li>Now we need to tell the trigger what to do when a ball hits it. In your project window, find the <strong>BallReturn.cs</strong> script and add it to the trigger.<blockquote>
<p>As before, you can do this with the <strong>Component</strong> menu, the <strong>Add Component</strong> button in the inspector, or by drag-and-drop from the project&nbsp;window.</p>
</blockquote>
</li>
<li>Open up the BallReturn.cs script by double clicking it in your project window. This will open <strong>MonoDevelop</strong>, the programmers text editor which was installed along with your&nbsp;Unity. </li>
<li>The function <code>OnTriggerEnter</code> is called when a <a href="glossary#rigidbody">RigidBody</a> moves into the trigger. The critical line here is:
    <code>other.gameObject.SendMessage("Reset", _Ball, SendMessageOptions.DontRequireReceiver);</code>
Which translates into &#8220;when a something enters this trigger, send it a <code>Reset</code> message&#8221;.  The message will check every component on the colliding object, and if it finds a function named <code>Reset</code> it will call the function. That means we need to add a component with a <code>Reset</code> function to the&nbsp;ball.</li>
<li>Add the script component <strong>ResetBallPosition</strong> to the ball object.  Double click on the <strong>ResetBallPosition.cs</strong> icon in the project window to see the script.  Here the important lines are <code>_Position = gameObject.transform.position;</code>, which runs when the game starts and saves the location of the ball into a variable called <code>_Position</code>, and then further down <code>gameObject.transform.position = _Position;</code> which resets the ball&#8217;s position to match the saved&nbsp;location.</li>
<li>Now test the game again with <strong>Ctrl+P</strong>.  2 seconds after the ball falls off the end of the alley, it should reappear back where it started. You can keep throwing the ball&#8230; but the pins aren&#8217;t resetting&nbsp;yet. </li>
</ol>
<p><a href="ex1-6">Back</a>
<a href="ex1-8">Next</a></p>

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>,
                which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->
        </footer><!-- /#contentinfo -->
</body>
</html>